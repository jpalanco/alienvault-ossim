# Alienvault plugin
# Author: Alienvault Team at devel@alienvault.com
# Plugin rsa-secureid id:1593 version: 0.0.1
# Last modification: 2013-06-05 09:29
#
# Accepted products:
# rsa - securid 6.1
# Description:
# 
# Written to handle RSA/ACE events generated by ntsyslog/snare etc 
# and captured on a syslog server
# 
# Matches general RSA events
# Plugin built for RSA (SecurID) server version 6.1 running on a Windose box
# Log events on the syslog server are generated by "snare" agent but this should also
# word for ntsyslog generated events.
#
#

[DEFAULT]
plugin_id=1593

[config]
type=detector
enable=yes
source=log
location=/var/log/radius-rsa
create_file=true

process=
start=no   
stop=no
startup=
shutdown=


[RSA Event]
event_type=event
regexp="^(?P<logline>^(?P<date>\S+\s+\d+\s+\d\d:\d\d:\d\d)\s+(?P<sensor>\S+?)\s+.*\s+(?P<sid>\d+)\s+ACESERVER.*\s+Devices\s+(?P<message>.*?)\s+\(Login:'(?P<username>.*?)';\s+User Name:'(?P<full_name>.*?)';\s+Token:'(?P<token>.*?)';\s+Group:'(?P<group>.*?)';\s+Site:'(?P<site>.*?)';\s+.*$)"
device={resolv($sensor)}
date={normalize_date($1)}
plugin_sid={$sid}
username={$username}
userdata1={$full_name}
userdata2={$group}
userdata3={$token}
userdata4={$message}
userdata9={md5sum($logline)}

[RSA system Event]
event_type=event
regexp="^(?P<logline>^(?P<date>\S+\s+\d+\s+\d\d:\d\d:\d\d)\s+(?P<sensor>\S+?)\s+.*\s+(?P<sid>\d+)\s+ACESERVER.*\s+(Devices|Shell)\s+(?P<message>.*)$)"
device={resolv($sensor)}
date={normalize_date($1)}
plugin_sid={$sid}
userdata1={$message}
userdata9={md5sum($logline)}
