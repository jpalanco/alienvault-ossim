# Alienvault plugin
# Author: Alienvault Team at avteam@alienvault.com
# Plugin bit9_v7 id:1696 version: 0.0.1
# Last modification: 2014-10-23 13:00
#
# Accepted products:
# bit9 - Trust-based Security Platform 7.0.1.1892
#
# Description:
# The Bit9 Trust-based Security Platform monitors and records all activity on servers and endpoints to detect and stop cyber threats.
#
#
#
# ***************************************************
# *     Event Types by category and subcategory     *
# ***************************************************
#
# Audit Data Generation in Parity Application Server 
# ---------------------------------------------------
#
# + Server Management
#   - Server Shutdown
#   - Server restart
#   - Server config modified
#   - Server backup started
#   - Server backup failed
#   - Server backup missed
#   - Database server reached specified limit
#   - Old events were deleted
#   - Database verification error
#   - File tracking disabled
#   - Server backup stopped
#   - Server upgrade succeeded
#   - Server upgrade failed
#   - Server config list error
#   - AD lookups are slow
#   - License added
#   - License error
#   - License warning
#   - New certificate generated
#   - New certificate generation failed
#   - Certificate imported
#   - Certificate import failed
#   - Strong SSL communications changed
#   - Certificate expiring
#   - Certificate expired
#   - Agent certificate expired
#   - Agent communications disabled
#   - Common Name mismatch
#   - Database error
#   - Communication error
#   - System error
#   - Parity Knowledge connection lost
#   - Parity Knowledge connection restored
#   - Parity Knowledge proxy set
#   - Parity Knowledge proxy cleared
#   - Reporter error
#   - Reporter task execution
#
# + Discovery
#   - New publisher found
#   - File group created
#   - New pending file to computer
#   - Banned file written to computer
#   - New file on network
#   - First execution on network
#   - New device found
#   - Device attached
#   - Device detached
#   - Computer added
#   - Computer deleted
#   - Computer modified
#   - CLI password reset
#   - Agent shutdown
#   - Agent restart
#   - Agent policy changed
#   - Agent SecCon changed
#   - Agent policy updated
#   - Agent upgraded
#   - Agent synchronization started
#   - Agent synchronization finished
#   - Agent bulk state change finished
#   - Agent bulk state change requested
#   - Agent deleted events
#   - Agent requires upgrade
#   - Cache check start
#   - Cache check complete
#   - Cache check error
#   - Agent synchronization requested
#   - Temporary SecCon override
#   - Temporary SecCon restore
#   - Agent uninstalled
#   - File receive error
#   - File process error
#   - Installer rescan requested
#   - Automatic synchronization scheduled
#   - CLI executed
#   - Unauthorized computer registration
#   - Certificate checked
#   - New unapproved file to computer
#
# + General Management
#   - Alert created
#   - Alert deleted
#   - Alert modified
#   - Alert triggered
#   - Alert reset
#   - Meter created
#   - Meter deleted
#   - Meter modified
#   - Baseline drift report created
#   - Baseline drift report deleted
#   - Baseline drift report modified
#   - Baseline drift report generated
#   - Baseline drift report generation is slow
#   - Snapshot created
#   - Snapshot deleted
#   - Snapshot modified
#
# + Policy Management
#   - AD rules changed
#   - AD rules loaded
#   - Custom rule created
#   - Custom rule deleted
#   - Custom rule modified
#   - Device approval created
#   - Device approval removed
#   - File approval created
#   - File approval modified
#   - File approval deleted
#   - File ban created
#   - File ban deleted
#   - File ban modified
#   - File group local approval
#   - File local approval
#   - File remove local approval
#   - Group remove local approval
#   - Install package created
#   - Memory rule created
#   - Memory rule deleted
#   - Memory rule modified
#   - Policy created
#   - Policy deleted
#   - Policy file tracking changed
#   - Policy modified
#   - Publisher approval created
#   - Publisher approval removed
#   - Publisher modified
#   - Registry rule created
#   - Registry rule deleted
#   - Registry rule modified
#   - Trusted directory check
#   - Trusted directory created
#   - Trusted directory deleted
#   - Trusted directory import
#   - Trusted directory modified
#   - Trusted directory scan
#   - Trusted User added
#   - Trusted User deleted
#   - Updater disabled
#   - Updater enabled
#   - Approval Request Created
#
# + Parity Knowledge
#   - Potential risk file detected
#   - Malicious file detected
#
# + Policy Enforcement
#   - Access approved (memory rule)
#   - Access block (memory rule)
#   - Execution allowed (custom rule)
#   - Execution allowed (trusted user)
#   - Execution block (banned file)
#   - Execution block (custom rule)
#   - Execution block (network file)
#   - Execution block (pending file)
#   - Execution block (removable media)
#   - Execution block (still analyzing)
#   - File access error
#   - File approved (block and ask)
#   - File approved (local approval)
#   - File approved (publisher)
#   - File approved (trusted user)
#   - File approved (updater)
#   - Metered execution
#   - Process demoted
#   - Read block (removable media)
#   - Report access (memory rule)
#   - Report execution (removable media)
#   - Report execution block (banned file)
#   - Report read (removable media)
#   - Report write (custom rule)
#   - Report write (registry rule)
#   - Report write (removable media)
#   - Self protection block
#   - Write approved (custom rule)
#   - Write block (custom rule)
#   - Write block (registry rule)
#   - Write block (removable media)
#   - Console user created
#   - Console user deleted
#   - Console user login
#   - Console user logout
#   - Console user modified
#   - Multiple failed logins
#   - Execution block (unapproved file)
#   - File approved (cache consistency)
#   - File approved (custom rule)
#   - File approved (system update)
#   - Report execution (custom rule)
#   - Tamper protection
#
#
# Audit Data Generation in Parity Client
# ---------------------------------------
#
# + Computer Management
#   - Agent shutdown
#   - Agent restart
#   - Cache check complete
#   - Cache check error
#   - Temporary SecCon Override
#   - Temporary SecCon Restore
#   - Agent uninstalled
#   - File receive error
#   - File process error
#   - Agent resync requested
#   - Cache check start
#   - CLI executed
#   - Agent database error
#   - Agent Enforcement Level changed
#   - Agent error
#   - Agent health check
#   - Configuration changed
#
# + Discovery
#   - Device attached
#   - Device detached
#   - New device found
#   - Certificate checked
#   - New unapproved file to computer
#
# + Policy Enforcement
#   - Access approved (memory rule)
#   - Access block (memory rule)
#   - Execution allowed (trusted user)
#   - Execution block (banned file)
#   - Execution block (custom rule)
#   - Execution block (network file)
#   - Execution block (pending file)
#   - Execution block (removable media)
#   - Execution block (still analyzing)
#   - Execution allowed (custom rule)
#   - File access error
#   - File approved (block and ask)
#   - File approved (local approval)
#   - File approved (publisher)
#   - File approved (trusted user)
#   - File approved (updater)
#   - Metered execution
#   - Process demoted
#   - Read block (removable media)
#   - Report access (memory rule)
#   - Report execution (removable media)
#   - Report execution block (banned file)
#   - Report read (removable media)
#   - Report write (custom rule)
#   - Report write (registry rule)
#   - Report write (removable media)
#   - Self protection block
#   - Write approved (custom rule)
#   - Write block (custom rule)
#   - Write block (registry rule)
#   - Write block (removable media)
#   - Execution block (unapproved file)
#   - File approved (cache consistency)
#   - File approved (custom rule)
#   - File approved (system update)
#   - Report execution (custom rule)
#   - Tamper protection
#
# + Policy Management
#   - Trusted directory check
#   - Trusted directory scan
#   - Approval Request Created


[DEFAULT]
plugin_id=1696

[config]
type=detector
enable=yes

source=log
location=/var/log/syslog

create_file=false

process=
start=no   
stop=no
startup=
shutdown=

[translation]
Access approved (memory rule)=1
Access block (memory rule)=2
AD lookups are slow=3
AD rules changed=4
AD rules loaded=5
Agent bulk state change finished=6
Agent bulk state change requested=7
Agent certificate expired=8
Agent communications disabled=9
Agent database error=10
Agent deleted events=11
Agent Enforcement Level changed=12
Agent error=13
Agent health check=14
Agent policy changed=15
Agent policy updated=16
Agent requires upgrade=17
Agent restart=18
Agent resync requested=19
Agent SecCon changed=20
Agent shutdown=21
Agent synchronization finished=22
Agent synchronization requested=23
Agent synchronization started=24
Agent uninstalled=25
Agent upgraded=26
Alert created=27
Alert deleted=28
Alert modified=29
Alert reset=30
Alert triggered=31
Approval Request Created=32
Automatic synchronization scheduled=33
Banned file written to computer=34
Baseline drift report created=35
Baseline drift report deleted=36
Baseline drift report generated=37
Baseline drift report generation is slow=38
Baseline drift report modified=39
Cache check complete=40
Cache check error=41
Cache check start=42
Certificate checked=43
Certificate expired=44
Certificate expiring=45
Certificate imported=46
Certificate import failed=47
CLI executed=48
CLI password reset=49
Common Name mismatch=50
Communication error=51
Computer added=52
Computer deleted=53
Computer modified=54
Configuration changed=55
Console user created=56
Console user deleted=57
Console user login=58
Console user logout=59
Console user modified=60
Custom rule created=61
Custom rule deleted=62
Custom rule modified=63
Database error=64
Database server reached specified limit=65
Database verification error=66
Device approval created=67
Device approval removed=68
Device attached=69
Device detached=70
Execution allowed (custom rule)=71
Execution allowed (trusted user)=72
Execution block (banned file)=73
Execution block (custom rule)=74
Execution block (network file)=75
Execution block (pending file)=76
Execution block (removable media)=77
Execution block (still analyzing)=78
Execution block (unapproved file)=79
File access error=80
File approval created=81
File approval deleted=82
File approval modified=83
File approved (block and ask)=84
File approved (cache consistency)=85
File approved (custom rule)=86
File approved (local approval)=87
File approved (publisher)=88
File approved (system update)=89
File approved (trusted user)=90
File approved (updater)=91
File ban created=92
File ban deleted=93
File ban modified=94
File group created=95
File group local approval=96
File local approval=97
File process error=98
File receive error=99
File remove local approval=100
File tracking disabled=101
First execution on network=102
Group remove local approval=103
Installer rescan requested=104
Install package created=105
License added=106
License error=107
License warning=108
Malicious file detected=109
Memory rule created=110
Memory rule deleted=111
Memory rule modified=112
Meter created=113
Meter deleted=114
Metered execution=115
Meter modified=116
Multiple failed logins=117
New certificate generated=118
New certificate generation failed=119
New device found=120
New file on network=121
New pending file to computer=122
New publisher found=123
New unapproved file to computer=124
Old events were deleted=125
Parity Knowledge connection lost=126
Parity Knowledge connection restored=127
Parity Knowledge proxy cleared=128
Parity Knowledge proxy set=129
Policy created=130
Policy deleted=131
Policy file tracking changed=132
Policy modified=133
Potential risk file detected=134
Process demoted=135
Publisher approval created=136
Publisher approval removed=137
Publisher modified=138
Read block (removable media)=139
Registry rule created=140
Registry rule deleted=141
Registry rule modified=142
Report access (memory rule)=143
Reporter error=144
Reporter task execution=145
Report execution block (banned file)=146
Report execution (custom rule)=147
Report execution (removable media)=148
Report read (removable media)=149
Report write (custom rule)=150
Report write (registry rule)=151
Report write (removable media)=152
Self protection block=153
Server backup failed=154
Server backup missed=155
Server backup started=156
Server backup stopped=157
Server config list error=158
Server config modified=159
Server restart=160
Server Shutdown=161
Server upgrade failed=162
Server upgrade succeeded=163
Snapshot created=164
Snapshot deleted=165
Snapshot modified=166
Strong SSL communications changed=167
System error=168
Tamper protection=169
Temporary SecCon override=170
Temporary SecCon Override=171
Temporary SecCon restore=172
Temporary SecCon Restore=173
Trusted directory check=174
Trusted directory created=175
Trusted directory deleted=176
Trusted directory import=177
Trusted directory modified=178
Trusted directory scan=179
Trusted User added=180
Trusted User deleted=181
Unauthorized computer registration=182
Updater disabled=183
Updater enabled=184
Write approved (custom rule)=185
Write block (custom rule)=186
Write block (registry rule)=187
Write block (removable media)=188

[0001 - bit9_v7 - ParityServer event]
precheck="ParityServer"
regexp="(?P<date>\w{3}\s+\d{1,2}\s(\d{4}\s)?\d\d:\d\d:\d\d)(?:\s+|:)((?P<device>\S+)\s*:?)?\s+Bit9 ParityServer event:\s+text="(?P<event>.+)"\s+type="(?P<event_type>[^"]+)"\s+subtype="(?P<event_subtype>[^"]+)"\s+hostname="(?P<hostname>\S*)"\s+(username="(?P<username>[^"]*)"\s+)?date="(?P<event_date>[^"]*)"\s+(ip_address="(?P<src_ip>\S*)"\s+)?(process="(?P<process>[^"]*)"\s+)?(file_path="(?P<file_path>[^"]*)"\s+)?(file_name="(?P<file_name>[^"]*)"\s+)?(file_hash="(?P<file_hash>[^"]*)"\s+)?(installer_name="(?P<installer_name>[^"]*)"\s+)?(policy="(?P<policy>[^"]*)"\s+)?(rule_name="(?P<rule_name>[^"]*)"\s+)?.*?server_version="(?P<server_version>[^"]*)["]"
event_type=event
date={normalize_date($date)}
plugin_sid={translate($event_subtype)}
device={resolv($device)}
src_ip={$src_ip}
username={$username}
filename={$file_name}
userdata1={$event}
userdata2={$event_type}
userdata3={$event_subtype}
userdata4={$hostname}
userdata5={$process}
userdata6={$file_path}
userdata7={$installer_name}
userdata8={$server_version}
