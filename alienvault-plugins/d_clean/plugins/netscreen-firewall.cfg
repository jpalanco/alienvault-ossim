# Alienvault plugin
# Author: Alienvault Team at devel@alienvault.com
# Plugin netscreen-firewall id:1522 version: 0.0.1
# Last modification: 2013-06-04 16:46
#
# Accepted products:
# netscreen - firewall -
# Description:
# 
#
#

[DEFAULT]
plugin_id=1522

[config]
type=detector
enable=yes

source=log
location=/var/log/netscreen.log
create_file=false

process=
start=no
stop=no
startup=
shutdown=

[translation]

SYN flood=3
Teardrop attack=4
Ping of Death=5
WinNuke attack=6
IP spoofing=7
Source Route IP option=8
Land attack=9
ICMP flood=10
UDP flood=11
Port scan=12
Address sweep=13
Malicious URL=14
Src IP session limit=15
SYN fragment=16
No TCP flag=17
Unknown protocol=18
Bad IP option=19
Dst IP session limit=20
ZIP file blocked=21
Java applet blocked=22
EXE file blocked=23
ActiveX control blocked=24
ICMP fragment=25
Large ICMP packet=26
SYN and FIN bits=27
FIN but no ACK bit=28
SYN-ACK-ACK Proxy DoS=29
Fragmented traffic=30
DNS:EXPLOIT:CLASS-UNKNOWN attack=31
DNS:EXPLOIT:EMPTY-UDP-MSG attack=32
DNS:EXPLOIT:EXPLOIT-BIND9-RT attack=33
DNS:EXPLOIT:POINTER-LOOP attack=34
DNS:EXPLOIT:REQUEST-SHORT-MSG attack=35
DNS:EXPLOIT:TYPE-AXFR attack=36
DNS:EXPLOIT:TYPE-UNKNOWN attack=37
DNS:HEADERERROR:INVALID-OPCODE attack=38
DNS:OVERFLOW:BIN attack=39
DNS:OVERFLOW:INVALID-LABEL-LEN attack=40
DNS:OVERFLOW:INVALID-POINTER attack=41
DNS:OVERFLOW:NAME-TOO-LONG attack=42
DNS:OVERFLOW:OVERSIZED-UDP-MSG attack=43
DNS:OVERFLOW:TOO-LONG-TCP-MSG attack=44
DNS:REPERR:QCLASS-UNEXP attack=45
DNS:REPERR:REP-MISMATCHING-AN attack=46
DNS:REPERR:REP-MISMATCHING-QD attack=47
DNS:REPERR:REP-QTYPE-UNEXPECTED attack=48
DNS:REPERR:REP-S2C-QUERY attack=49
DNS:REPERR:REQ-INVALID-HDR-RD attack=50
DNS:REQERR:REQ-ANSWERS-IN-QUERY attack=51
DNS:REQERR:REQ-C2S-RESPONSE attack=52
DOS:NETDEV:IOS-HTTPD-DOS attack=53
DOS:NETDEV:NETWORK-3COM-DOS attack=54
FTP:COMMAND:PLATFTP-CD-DOS attack=55
FTP:COMMAND:SITE-EXEC attack=56
FTP:DIRECTORY:DOT-DOT attack=57
FTP:DIRECTORY:DOT-PCT-20-DOT attack=58
FTP:EXPLOIT:BOUNCE-ATTACK attack=59
FTP:EXPLOIT:ILLEGAL-PORT attack=60
FTP:EXPLOIT:SYNTAX-ERROR attack=61
FTP:MS-FTP:ASTERISK attack=62
FTP:MS-FTP:STAT-GLOB attack=63
FTP:OVERFLOW:BSD-FTPD-MKD-OF attack=64
FTP:OVERFLOW:FREEBSD-FTPD-GLOB attack=65
FTP:OVERFLOW:LINE_TOO_LONG attack=66
FTP:OVERFLOW:OPENBSD-X86 attack=67
FTP:OVERFLOW:PASS_TOO_LONG attack=68
FTP:OVERFLOW:PATH-LINUX-X86-1 attack=69
FTP:OVERFLOW:PATH-LINUX-X86-2 attack=70
FTP:OVERFLOW:PATH-LINUX-X86-3 attack=71
FTP:OVERFLOW:PATH-TOO-LONG attack=72
FTP:OVERFLOW:SITESTRING-2-LONG attack=73
FTP:OVERFLOW:USERNAME-2-LONG attack=74
FTP:OVERFLOW:WFTPD-MKD-OVERFLOW attack=75
FTP:OVERFLOW:WUBSD-SE-RACE attack=76
FTP:PABLO-FTP:FORMAT-STRING attack=77
FTP:PASSWORD:4DGIFTS attack=78
FTP:PASSWORD:H0TB0X attack=79
FTP:PASSWORD:LRKR0X attack=80
FTP:PASSWORD:SATORI attack=81
FTP:PASSWORD:WH00T attack=82
FTP:PROFTP:LOGXFR-OF1 attack=83
FTP:PROFTP:MKD-OVERFLOW attack=84
FTP:PROFTP:OVERFLOW1 attack=85
FTP:PROFTP:PPC-FS1 attack=86
FTP:PROFTP:PPC-FS2 attack=87
FTP:PROFTP:SIZE-DOS2 attack=88
FTP:PROFTP:USER-DOS attack=89
FTP:REQERR:LOGIN-FAILED attack=90
FTP:REQERR:REQ-INVALID-CMD-SEQ attack=91
FTP:REQERR:REQ-MISSING-ARGS attack=92
FTP:REQERR:REQ-NESTED-REQUEST attack=93
FTP:REQERR:REQ-UNKNOWN-CMD attack=94
FTP:RPLERR:REP-NESTED-REPLY attack=95
FTP:WS-FTP:CPWD attack=96
FTP:WU-FTP:DELE-OF attack=97
FTP:WU-FTP:FTPD-BSD-X86 attack=98
FTP:WU-FTP:GLOBARG attack=99
FTP:WU-FTP:IREPLY-FS attack=100
FTP:WU-FTP:LINUX-OF attack=101
FTP:WU-FTP:REALPATH-OF attack=102
FTP:WU-FTP:REALPATH-OF2 attack=103
HTTP:APACHE:NOSEJOB attack=104
HTTP:APACHE:PHP-INVALID-HDR attack=105
HTTP:APACHE:SCALP attack=106
HTTP:BIGBROTHER:DIR-TRAVERSAL attack=107
HTTP:CGI:ALTAVISTA-TRAVERSAL attack=108
HTTP:CGI:APPLE-QT-FILEDISC1 attack=109
HTTP:CGI:BNB-SURVEY-REMOTE-EXEC attack=110
HTTP:CGI:BUGZILLA-SEMICOLON attack=111
HTTP:CGI:DCFORUM-AZ-EXEC attack=112
HTTP:CGI:FORMMAIL-ENV-VAR attack=113
HTTP:CGI:HASSAN-DIR-TRAVERSAL attack=114
HTTP:CGI:HTDIG-INCLUSION attack=115
HTTP:CGI:HYPERSEEK-DIR-TRAVERSL attack=116
HTTP:CGI:INFOSRCH-REMOTE-EXEC attack=117
HTTP:CGI:MOREOVER-CACHE-FEED attack=118
HTTP:CGI:TECHNOTE-PRINT-DSCLSR attack=119
HTTP:CGI:W3-MSQL-CGI attack=120
HTTP:CGI:WEBPALS-EXEC attack=121
HTTP:CGI:WEBSPEED-WSMADMIN attack=122
HTTP:CGI:WEBSPIRS-FILE-DISCLSR attack=123
HTTP:CGI:YABB-DIR-TRAVERSAL attack=124
HTTP:CHKP-FW1-PROXY attack=125
HTTP:CISCO:IOS-ADMIN-ACCESS attack=126
HTTP:CISCO:VOIP:PORT-INFO-DOS attack=127
HTTP:CISCO:VOIP:STREAM-ID-DOS attack=128
HTTP:COLDFUSION:EXPRCALC-OPNFIL attack=129
HTTP:DIR:TRAVERSE-DIRECTORY attack=130
HTTP:EXPLOIT:AMBIG-CONTENT-LEN attack=131
HTTP:EXPLOIT:BLAZIX-JSPVIEW attack=132
HTTP:FRONTPAGE:ADMIN.PWD-REQ attack=133
HTTP:FRONTPAGE:FOURDOTS attack=134
HTTP:FRONTPAGE:SERVICE.PWD-REQ attack=135
HTTP:HOSTCTRL:BROWSE-ASP attack=136
HTTP:IIS:AD-SERVER-CONFIG attack=137
HTTP:IIS:ASP-CODEBROWSER-EXAIR attack=138
HTTP:IIS:BAT-& attack=139
HTTP:IIS:COMMAND-EXEC attack=140
HTTP:IIS:COMMAND-EXEC-2 attack=141
HTTP:IIS:DATA-DISCLOSURE attack=142
HTTP:IIS:DOUBLE-ENCODE attack=143
HTTP:IIS:FACTO-CMS-SQL-INJ attack=144
HTTP:IIS:HEADER-HOST-DOS attack=145
HTTP:IIS:ISAPI-IDQ-OVERFLOW attack=146
HTTP:IIS:ISAPI-PRINTER-OVERFLOW attack=147
HTTP:IIS:MDAC-RDS attack=148
HTTP:IIS:MDAC-RDS-2 attack=149
HTTP:IIS:NEWDSN-FILE-CREATION attack=150
HTTP:IIS:OUTLOOK-WEB-DOS attack=151
HTTP:IIS:WEBDAV:MALFORMED-REQ1 attack=152
HTTP:IIS:WEBDAV:MALFORMED-REQ2 attack=153
HTTP:INFO-LEAK:VIGNETTE-LEAK attack=154
HTTP:INFO-LEAK:WEB-INF-DOT attack=155
HTTP:IRIX:CGI-BIN-WRAP attack=156
HTTP:MISC:HP-PROCURVE-RESET attack=157
HTTP:MISC:HTACCESS-ATTEMPT attack=158
HTTP:NOVELL:NETWARE-CONVERT.BAS attack=159
HTTP:OREILLY:WIN-C-SMPLE-OVFLOW attack=160
HTTP:OVERFLOW:CHUNK-LEN-OFLOW attack=161
HTTP:OVERFLOW:CHUNK-OVERFLOW attack=162
HTTP:OVERFLOW:CONTENT-OVERFLOW attack=163
HTTP:OVERFLOW:HEADER attack=164
HTTP:OVERFLOW:INV-CHUNK-LEN attack=165
HTTP:OVERFLOW:PI3WEB-SLASH-OF attack=166
HTTP:OVERFLOW:URL-OVERFLOW attack=167
HTTP:PHP:ACHIEVO-EXEC attack=168
HTTP:PHP:DFORUM-PHP-INC attack=169
HTTP:PHP:DOTPROJECT-USERCOOKIE attack=170
HTTP:PHP:FI-DIR-TRAVERSAL attack=171
HTTP:PHP:GALLERY-MAL-INCLUDE attack=172
HTTP:PHP:MANTIS-ARB-EXEC1 attack=173
HTTP:PHP:MANTIS-ARB-EXEC2 attack=174
HTTP:PHP:MLOG-SCREEN attack=175
HTTP:PHP:PHORUM:ADMIN-PW-CHG attack=176
HTTP:PHP:PHORUM:READ-ACCESS attack=177
HTTP:PHP:PHORUM:REMOTE-EXEC attack=178
HTTP:PHP:PHPLIB-REMOTE-EXE attack=179
HTTP:PHP:PHPNUKE:MODULES-DOS attack=180
HTTP:PHP:PHPWEB-REMOTE-FILE attack=181
HTTP:PHP:PMACHINE-INCLUDE attack=182
HTTP:PHP:POSTNUKE-SQL-EXEC attack=183
HTTP:PHP:REDHAT-PIRANHA-PASSWD attack=184
HTTP:PHP:VBULL-CAL-EXEC attack=185
HTTP:PHP:WOLTAB-SQL-INJ attack=186
HTTP:PHP:YABBSE-PKG-EXEC attack=187
HTTP:PHP:YABBSE-SSI-INCLUDE attack=188
HTTP:PHP:ZENTRACK-CMD-EXEC attack=189
HTTP:PKG:ALLAIRE-JRUN-DOS attack=190
HTTP:PKG:DB4WEB-FILE-ACCESS-LIN attack=191
HTTP:PKG:EWAVE-SERVLET-DOS attack=192
HTTP:PKG:MOUNTAIN-ORDR-DSCLSR attack=193
HTTP:PKG:WEBGAIS-REMOTE-EXEC attack=194
HTTP:REQERR:REQ-INVALID-FORMAT attack=195
HTTP:REQERR:REQ-LONG-UTF8CODE attack=196
HTTP:REQERR:REQ-MALFORMED-URL attack=197
HTTP:TOMCAT:JSP-AS-HTML attack=198
HTTP:TOMCAT:SERVLET-DEVICE-DOS attack=199
HTTP:WASD:CONF-ACCESS attack=200
HTTP:WASD:DIR-TRAV attack=201
HTTP:WEBLOGIC:URL-REVEAL-SRC attack=202
HTTP:WEBLOGIC:WEBROOT attack=203
HTTP:WEBPLUS:DIR-TRAVERSAL attack=204
HTTP:WIN-CMD:WIN-RGUEST attack=205
HTTP:WIN-CMD:WIN-WGUEST attack=206
IMAP:OVERFLOW:COMMAND attack=207
IMAP:OVERFLOW:FLAG attack=208
IMAP:OVERFLOW:IMAP4-LSUB-OF attack=209
IMAP:OVERFLOW:LINE attack=210
IMAP:OVERFLOW:MAILBOX attack=211
IMAP:OVERFLOW:PASS attack=212
IMAP:OVERFLOW:REFERENCE attack=213
IMAP:OVERFLOW:TAG attack=214
IMAP:OVERFLOW:USER attack=215
IMAP:REQERR:LOGIN-FAILED attack=216
IMAP:REQERR:REQ-INVALID-STATE attack=217
IMAP:REQERR:REQ-INVALID-TAG attack=218
IMAP:REQERR:REQ-UNEXPECTED-ARG attack=219
POP3:DOS:MDAEMON-POP-DOS attack=220
POP3:OVERFLOW:APOP attack=221
POP3:OVERFLOW:COMMAND attack=222
POP3:OVERFLOW:LINE attack=223
POP3:OVERFLOW:PASS attack=224
POP3:OVERFLOW:QPOP-OF1 attack=225
POP3:OVERFLOW:QPOP-OF2 attack=226
POP3:OVERFLOW:QPOP-OF3 attack=227
POP3:OVERFLOW:QPOP-OF4 attack=228
POP3:OVERFLOW:USER attack=229
POP3:REQERR:LOGIN-FAILED attack=230
POP3:REQERR:REQ-INVALID-STATE attack=231
POP3:REQERR:REQ-MESSAGE-NUMBER attack=232
POP3:REQERR:REQ-NESTED-REQUEST attack=233
POP3:REQERR:REQ-SYNTAX-ERROR attack=234
POP3:REQERR:REQ-UNKNOWN-CMD attack=235
SHELLCODE:AIX:NOOP-PKT attack=236
SHELLCODE:BSDX86:GEN-1-PKT attack=237
SHELLCODE:BSDX86:GEN-2-PKT attack=238
SHELLCODE:DIGITAL:NOOP-PKT attack=239
SHELLCODE:HP-UX:HP-NOOP-1-PKT attack=240
SHELLCODE:HP-UX:HP-NOOP-2-PKT attack=241
SMTP:COMMAND:DEBUG attack=242
SMTP:COMMAND:ETRN attack=243
SMTP:COMMAND:EXPN attack=244
SMTP:COMMAND:SMTP-VRFY-CMD attack=245
SMTP:COMMAND:TURN attack=246
SMTP:COMMAND:VRFY attack=247
SMTP:COMMAND:WIZ attack=248
SMTP:EMAIL:HEADER-FROM-PIPE attack=249
SMTP:EMAIL:HEADER-TO-PIPE attack=250
SMTP:EMAIL:MAIL-FROM-PIPE attack=251
SMTP:EMAIL:RCPT-TO-DECODE attack=252
SMTP:EMAIL:RCPT-TO-PIPE attack=253
SMTP:EMAIL:REPLY-TO-PIPE attack=254
SMTP:EXCHANGE:DOS attack=255
SMTP:MAJORDOMO:COMMAND-EXEC attack=256
SMTP:MSSQL-WORM-EMAIL attack=257
SMTP:OVERFLOW:COMMAND-LINE attack=258
SMTP:OVERFLOW:EMAIL-ADDRESS attack=259
SMTP:OVERFLOW:EMAIL-DOMAIN attack=260
SMTP:OVERFLOW:EMAIL-USERNAME attack=261
SMTP:OVERFLOW:OUTLOOK-CERT-OF attack=262
SMTP:OVERFLOW:REPLY-LINE attack=263
SMTP:OVERFLOW:SENDMAIL-CMT-OF1 attack=264
SMTP:OVERFLOW:SENDMAIL-CMT-OF2 attack=265
SMTP:OVERFLOW:TOO-MANY-RCPT attack=266
SMTP:REPERR:REP-INVALID-REPLY attack=267
SMTP:REPERR:REP-NESTED-REPLY attack=268
SMTP:REQERR:REQ-INVALID-CMD-SEQ attack=269
SMTP:REQERR:REQ-NESTED-REQUEST attack=270
SMTP:REQERR:REQ-SYNTAX-ERROR attack=271
SMTP:REQERR:REQ-UNKNOWN-CMD attack=272
SMTP:RESPONSE:PIPE-FAILED attack=273
SMTP:SENDMAIL:ADDR-PRESCAN-ATK attack=274
SMTP:SENDMAIL:SENDMAIL-FF-OF attack=275
TROJAN:QAZ:TCP25-CALLING-HOME attack=276
WORM:CODERED-2:CMD-BACKDOOR attack=277
WORM:CODERED-2:INFECT-ATTEMPT attack=278
WORM:CODERED-2:ROOT-BACKDOOR attack=279
WORM:NIMDA:BIN-255-CMD attack=280
WORM:NIMDA:MSADC-ROOT attack=281
WORM:NIMDA:SCRIPTS-C11C-CMD attack=282
WORM:NIMDA:SCRIPTS-CMD attack=283
WORM:NIMDA:SCRIPTS-ROOT attack=284

Tunnel=291

Permit=1000
Deny=1001
Reject=1001

on=2000
in=2000
warning-00519=2000
information-00519=2000
out=2001
attempt=2002
warning-00518=2002
Multiple login failures=2003

failed=2002
successful=2000

AV: VIRUS FOUND:=3000

information-00542=4000

SNMP: NetScreen device=5000
SNMP request from=5001

The system clock=6000

system-notification-00625=7000

critical-00601=8000

detected an IP conflict=9000

enabled=10000
disabled=10001
removed=10002
added=10003
changed=10004
cleared=10005

System configuration saved=11000

notification-00008=6001
notification-00011=4001
notification-00767=6002


[netscreen-firewall-BA-traffic]
precheck="start_time"
regexp="^(?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+).*?proto=(?P<proto>\S+).*?action=(?P<action>(?P<sid>\S+).*?) sent=.*?src=(?P<src>\S+)\s+dst=(?P<dst>\S+)(?:\ssrc_port=(?P<sport>\S+)\sdst_port=(?P<dport>\S+))?"
event_type=event
plugin_sid={translate($sid)}
date={normalize_date($date)}
src_ip={$src}
src_port={$sport}
dst_ip={$dst}
dst_port={$dport}
protocol={normalize_protocol($proto)}
userdata1=action: {$action}
device={$sensor}

[netscreen-firewall-BB-traffic]
precheck="src-ip"
regexp="^(?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+).*?src-ip\s(?P<src>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\s+dst-ip\s(?P<dst>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\sdst\sport\s(?P<dport>\S+)\)"
event_type=event
plugin_sid=7000
date={normalize_date($date)}
src_ip={$src}
dst_ip={$dst}
dst_port={$dport}
device={$sensor}

[netscreen-firewall-CA-attack]
precheck="!"
regexp="^(?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+).*?\w+-\w+-\w+:\s(?P<sid>[^!]+).*?\sFrom\s(?P<src>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?:[:/](?P<sport>\d{1,5}))?.*?to\s(?P<dst>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?:[:/](?P<dport>\d{1,5}))?(?:,.*?proto(?:col)?\s(?P<proto>\S+))?"
event_type=event
plugin_sid={translate($sid)}
date={normalize_date($date)}
src_ip={$src}
src_port={$sport}
dst_ip={$dst}
dst_port={$dport}
protocol={normalize_protocol($proto)}
userdata1=message: {$sid}
device={$sensor}

[netscreen-firewall-CB-attack]
precheck="VIRUS FOUND"
regexp="^(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s(?P<sensor>\S+).*?AV: VIRUS FOUND:\s(?P<src>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}):(?P<sport>\d{1,5})->(?P<dst>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}):(?P<dport>\d{1,5})"
event_type=event
plugin_sid=3000
date={normalize_date($date)}
src_ip={$src}
src_port={$sport}
dst_ip={$dst}
dst_port={$dport}
device={$sensor}

[netscreen-firewall-CC-attack]
precheck="has been detected from"
regexp="^(?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+).*?\sfrom\s(?P<src>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})/(?P<sport>\d{1,5}).*?to\s(?P<dst>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})/(?P<dport>\d{1,5})"
event_type=event
plugin_sid=8000
date={normalize_date($date)}
src_ip={$src}
src_port={$sport}
dst_ip={$dst}
dst_port={$dport}
device={$sensor}

[netscreen-firewall-DA-login]
precheck="dmin user"
regexp="(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s(?P<sensor>\S+).*?dmin\suser\s["]?(?P<user>[^"\s]+).*?log(?:ged|in).*?(?P<sid>in|on|out|attempt).*?(?:\(port\s(?P<dport>\d{1,5})\))?\sfrom.*?(?P<src>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?::|\susing\sport\s)(?P<sport>\d{1,5})"
event_type=event
plugin_sid={translate($sid)}
date={normalize_date($date)}
src_ip={$src}
dst_ip={$sensor}
src_port={$sport}
dst_port={dport}
username={$user}
userdata1=admin: Remote Admin User {$user} login event
device={$sensor}

[netscreen-firewall-DB-login]
precheck="login name"
regexp="^(?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+).*?-(?P<sid>\w+-\d+).*?login\sname\s(?P<user>\w+)"
event_type=event
plugin_sid={translate($sid)}
device={$sensor}
date={normalize_date($date)}
username={$user}

[netscreen-firewall-DC-login-failures]
precheck="Login attempt to system"
regexp="^(?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+).*?Login attempt to system by admin\s(?P<user>\S+)\svia\s\S+\sfrom\s(?P<src>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}):(?P<sport>\d{1,5})"
event_type=event
userdata1=login: login attempt for user {$user}
plugin_sid=2002
date={normalize_date($date)}
src_ip={$src}
dst_ip={$sensor}
src_port={$sport}
username={$user}
device={$sensor}

[netscreen-firewall-DD-login-failures]
precheck="Password authentication"
regexp="^(?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+).*?(?P<sid>failed|successful).*?user\s\'?(?P<user>[^']+).*host\s(?P<src>\d+\.\d+\.\d+\.\d+)"
event_type=event
plugin_sid={translate($sid)}
date={normalize_date($date)}
src_ip={$src}
dst_ip={$sensor}
username={$user}
device={$sensor}

[netscreen-firewall-DE-multiple-login-failures]
precheck="Multiple login failures"
regexp="^(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s(?P<sensor>\S+).*?Multiple\slogin\sfailures\soccurred\sfor\suser\s(?P<user>\S+)(?:\sfrom\sIP\saddress\s(?P<src>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}):(?P<sport>\d{1,5}))?"
event_type=event
userdata1=login: Multiple login failures for user {$user}
plugin_sid=2003
date={normalize_date($date)}
src_ip={$src}
dst_ip={$sensor}
src_port={$sport}
username={$user}
device={$sensor}

[netscreen-firewall-EA-arp-ip-conflict]
precheck="detected an IP conflict"
regexp="^(?P<date>\w{3}\s+\d{1,2}\s\d\d:\d\d:\d\d)\s(?P<sensor>\S+).*?arp (?:req|reply) detected an IP conflict \(IP\s(?P<src>\S+), MAC (?P<mac>\S+)\) on interface (?P<interface>\S+)"
event_type=event
plugin_sid=9000
date={normalize_date($date)}
src_ip={$src}
userdata1={$mac}
interface={$interface}
device={$sensor}

[netscreen-firewall-EB-BGP]
precheck="BGP peer"
regexp="^(?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+).*?BGP\speer\s(?P<src>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})"
event_type=event
plugin_sid=4000
device={$sensor}
date={normalize_date($date)}
src_ip={$src}
dst_ip={$sensor}
protocol=TCP

[netscreen-firewall-EC-SNMP]
precheck="successfully to the SNMP"
regexp="^(?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+).*?SNMP: NetScreen device at (?P<dst>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}):(?P<dport>\S+)"
event_type=event
plugin_sid=5000
device={$sensor}
date={normalize_date($date)}
src_ip={$sensor}
dst_ip={$dst}
dst_port={$dport}
protocol=UDP

[netscreen-firewall-ED-system]
regexp="^(?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+).*?-\w+-\d+:\s(?P<sid>\S+\s\S+\s\S+).*?(?:SNMP|NTP).*?(?P<src>\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?::(?P<sport>\S+))?"
event_type=event
plugin_sid={translate($sid)}
device={$sensor}
date={normalize_date($date)}
src_ip={$src}
src_port={$sport}
dst_ip={$sensor}
protocol=UDP

[netscreen-firewall-EE-syslog]
precheck="yslog"
regexp="^(?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+).*(?:servers?|for|from\shost|\s)\s(?P<src>\d+\.\d+\.\d+\.\d+)?.*?(?P<sid>enabled|disabled|removed|added|changed|cleared)(?:\sto\s(?P<sport>\d+))?"
event_type=event
plugin_sid={translate($sid)}
device={$sensor}
date={normalize_date($date)}
src_ip={$sensor}
dst_ip={$sensor}
src_port={$sport}

[netscreen-firewall-EF-system]
precheck="System configuration saved"
regexp="^(?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+).*?by\s(?P<user>[^\s]+).*(?:host|\s)\s(?:(?P<src>\d+\.\d+\.\d+\.\d+)\sto\s(?P<dst>\d+\.\d+\.\d+\.\d+):(?P<dport>\d+)\s)?"
event_type=event
plugin_sid=11000
device={$sensor}
date={normalize_date($date)}
src_ip={$src}
dst_ip={$dst}
dst_port={$dport}

[zzzz - netscreen-firewall - ##GENERIC-RULE##]
regexp="^(?P<date>\S+\s+\d+\s+\d+:\d+:\d+)\s+(?P<sensor>\S+).*?-(?P<sid>\w+-\d+)"
event_type=event
plugin_sid={translate($sid)}
device={$sensor}
date={normalize_date($date)}
